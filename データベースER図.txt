【データベースER図】

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ エンティティ関係図（テキスト形式）

┌─────────────────────────────────────┐
│            users                    │
├─────────────────────────────────────┤
│ id              (PK, UUID)          │
│ email           (UNIQUE, NOT NULL)  │
│ password_hash   (NOT NULL)          │
│ role            (NOT NULL, DEFAULT) │
│ created_at      (NOT NULL)          │
│ updated_at      (NOT NULL)          │
└─────────────────────────────────────┘
              │
              │ 1
              │
              │ has many
              │
              │ N
              ▼
┌─────────────────────────────────────┐
│        refresh_tokens               │
├─────────────────────────────────────┤
│ id              (PK, UUID)          │
│ user_id         (FK, NOT NULL)      │
│ token           (UNIQUE, NOT NULL)  │
│ expires_at      (NOT NULL)          │
│ created_at      (NOT NULL)          │
└─────────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ テーブル詳細

【users テーブル】
・主キー: id (UUID)
・ユニーク制約: email
・役割: ユーザー情報を格納

  カラム:
  - id: ユーザーの一意識別子（UUID形式）
  - email: メールアドレス（ユニーク、ログインIDとして使用）
  - password_hash: ハッシュ化されたパスワード
  - role: ユーザーの権限（デフォルト: "user"）
  - created_at: アカウント作成日時
  - updated_at: 最終更新日時

【refresh_tokens テーブル】
・主キー: id (UUID)
・外部キー: user_id → users.id (CASCADE DELETE)
・ユニーク制約: token
・インデックス: user_id, token
・役割: リフレッシュトークンを格納（認証システム用）

  カラム:
  - id: トークンレコードの一意識別子（UUID形式）
  - user_id: ユーザーID（usersテーブルへの外部キー）
  - token: リフレッシュトークンの値（ユニーク）
  - expires_at: トークンの有効期限
  - created_at: トークン作成日時

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ リレーションシップ

【users と refresh_tokens の関係】
・関係: 1対多（One-to-Many）
・説明: 1人のユーザーは複数のリフレッシュトークンを持つことができます
・削除動作: CASCADE DELETE（ユーザーを削除すると、関連するリフレッシュトークンも自動削除）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ インデックス

【refresh_tokens テーブル】
・user_id: ユーザーIDでの検索を高速化
・token: トークン値での検索を高速化（ユニーク制約も含む）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ データベース情報

・データベースタイプ: SQLite
・スキーマファイル: server/prisma/schema.prisma
・マイグレーション: server/prisma/migrations/

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


